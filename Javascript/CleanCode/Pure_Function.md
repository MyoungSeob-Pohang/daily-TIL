# 순수 함수

자바스크립트라는 언어는 동적인 언어이다. 굉장히 많은 부분이 동적으로 동작하는데, 주로 자바스크립트는 브라우저에서 다룬다. 브라우저를 사용하는 사용자가 수많은 입력을 하게 될텐데 어떤 값을 넣을지 어떠한 행동을 할지 제어하기가 힘들다. 이렇게 되면 상태를 예측 가능하기가 너무 어렵다. redux를 보면 예측가능하고 일관적으로 동작하고 테스트하기 쉽다 디버깅이 쉽다 이런얘기를 하고 있는데 핵심 규칙 중에 순수함수를 사용해야 한다 라는 얘기가 있다.  
순수함수라는 것은 부작용을 일으키지 않는 함수인데, 즉 사이트 이펙트를 일으키지 않는 것이다. 그 사이드 이펙트라는 것은,

1. 콘솔에 값 로깅
2. 파일 저장
3. 비동기 타이머 설정
4. AJAX HTTP 요청 만들기
5. 함수 외부에 존재하는 일부 상태 수정 또는 함수에 대한 인수 변경
6. 난수 또는 고유한 임의 ID 생성(예: Math.random()또는 Date.now())

위와 같은 것들을 일으키지 말라는 제약조건이 있다. 결국 위에 조건들이 순수함수를 비순수 함수로 바꾸는 조건들이라는 것이다. 말이 어려울 수 있는데 코드로 보자.

```
let num1 = 10;
let num2 = 20;

function impureSum1() {
    return num1 + num2;
}

function impureSum2(newNum) {
    return num1 + newNum;
}
```

위 함수는 비순수함수들이다. 왜 비순수함수일까 ? impureSum1을 호출하면 계속 30이라는 값이 나올 것인데, 왜 비순수 냐고 물어보면 누군가가 num1, num2의 값을 바꿀 수 있기 때문이다. 이 값들이 바뀌면 당연히 impureSum1의 호출 값도 달라지게 된다. 즉 순수함수라는 것은 동일한 입력에 대해 항상 동일한 출력을 반환하는 함수인 것이고 또한 외부의 상태를 변경하거나 영향을 받지 않는 함수이다. impureSum1은 외부에서 값 조작이 가능하기 때문에 순수하지 못한 것이다.  
impureSum2도 마찬가지이다. newNum이라는 인자를 받지만 num1 값이 변할 수 있다.  
그럼 위 함수들을 어떻게 순수하게 고칠 수 있을까,

```
function pureSum(num1, num2) {
    return num1 + num2;
}
```

위와 같이 간단하게 고칠 수 있다. 그럼 입력값이 같다면 항상 출력값도 같은 함수가 된 것이다. 그리고 외부에서 조작도 할 수 없다.

```
const obj = { one : 1 };

function changeObj(targetObj) {
    targetObj.one = 100;

    return targetObj;
}

changeObj(obj);
```

위 경우는 어떨까 ? const로 된 obj가 있고 changeObj가 객체를 받아 객체의 프로퍼티를 바꿔서 리턴하고 있다. 이정도면 순수하지 않을까 ? 출력은 당연히 one : 100이 나온다. 당연하다 인자로 넘어가서 속성값을 100을 바꿧으니까, 하지만 외부에서 값을 보면 어떨까 ? 똑같이 one : 100이 찍힌다. 이상하다.  
자바스크립트에서 객체는 일반적인 원시값과 다르게 동작한다. 자바스크립트에서 객체를 다룰 때에는 순수하게 새로운 객체를 만들어서 반환 하는 것이 좋다. 객체 배열을 다루는 함수를 만들때는 새롭게 만들어서 리턴하는 것이 좋다.

```
const obj = { one : 1 };

function changeObj(targetObj) {
    return {...targetObj, one : 100};
}

changeObj(obj); // one : 100
obj; // one : 1
```

위와 같은 코드로 변경하는 것이 좋다. 항상 순수함수를 만든다라는 의식적인 생각을 가지고 함수를 작성하는 연습을 하는 것이 좋다.
